{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AccessHealth Patient Signup</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <!-- Custom CSS -->
  <link rel="stylesheet" href="{% static 'style.css' %}" />
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
</head>
<body>

  <div class="container-fluid">
    <div class="row full-height">

      <!-- LEFT PANEL -->
      <div class="col-md-6 left-panel d-none d-md-block">
        <div class="d-flex align-items-center mb-4">
          <img src="{% static 'rwand.png'%}" alt="Rwanda Flag" class="flag-inline" />
          <h2 class="ms-2 mb-0">Made for Rwanda</h2>
        </div>

        <h3 class="mt-4">Join AccessHealth Today</h3>
        <p>Start your journey to better health.<br />Access quality healthcare services across all 30 districts of Rwanda.</p>

        <ul class="feature-list">
          <li>
            <i class="bi bi-geo-alt-fill"></i>
            <div><strong>Find Doctors Near You</strong><br />Search 5,000+ doctors by location, specialty, and cost</div>
          </li>
          <li>
            <i class="bi bi-robot"></i>
            <div><strong>AI Health Assistant</strong><br />Get instant health guidance 24/7</div>
          </li>
          <li>
            <i class="bi bi-shield-lock-fill"></i>
            <div><strong>Secure & Private</strong><br />Your health data is encrypted and protected</div>
          </li>
        </ul>
      </div>

      <!-- RIGHT PANEL -->
      <div class="col-md-6 right-panel">
        <div class="text-center mb-4">
          <div class="d-flex justify-content-center align-items-center">
            <img src="{% static 'heart.png' %}" alt="AccessHealth Logo" class="logo-img" />
            <h3 class="form-title m-0">AccessHealth</h3>
          </div>
          <h4 class="mt-3">Create Your Account</h4>
          <p>Sign up to access healthcare services across Rwanda</p>
        </div>

        <form method="post" action="">
          {% csrf_token %}
           {% if form.errors %}
            <ul>
                {% for field, errors in form.errors.items %}
                {% for error in errors %}
                <li>{{ field }}: {{ error }}</li>
                {% endfor %}
                {% endfor %}
              </ul>
          {% endif %}
          <div class="row">
              <div class="col-md-6 mb-3">
                <label>First Name</label>
                <input type="text" class="form-control" placeholder="First Name" name="first_name" required/>
              </div>
              <div class="col-md-6 mb-3">
                <label>Last Name</label>
                <input type="text" class="form-control" placeholder="Last Name" name="last_name" required/>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label>Date of Birth</label>
                <input type="date" class="form-control" name="dob" required/>
              </div>
              <div class="col-md-6 mb-3">
                <label>Gender</label>
                <select class="form-control" required name="gender">
                  <option disabled selected>Select</option>
                  <option value="M" {% if form.gender.value == 'M' %}selected{% endif %}>Male</option>
                  <option value="F" {% if form.gender.value == 'F' %}selected{% endif %}>Female</option>
                  <option value="O" {% if form.gender.value == 'O' %}selected{% endif %}>Other</option>
                </select>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label>National ID</label>
                <input type="text" class="form-control" placeholder="Enter your National ID" name="patient_national_id" required/>
              </div>
              <div class="col-md-6 mb-3">
                <label>Phone Number</label>
                <input type="text" class="form-control" placeholder="+250 XXX XXX XXX" name="phone_number"/>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label>Blood Type</label>
                <select class="form-control" name="blood_type">
                  <option disabled selected>Select Blood Type</option>
                  <option value="A+">A+</option>
                  <option value="A-">A-</option>
                  <option value="B+">B+</option>
                  <option value="B-">B-</option>
                  <option value="AB+">AB+</option>
                  <option value="AB-">AB-</option>
                  <option value="O+">O+</option>
                  <option value="O-">O-</option>
                  <option value="Unknown">Unknown</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label>Emergency Contact</label>
                <input type="text" class="form-control" placeholder="Name & Phone (e.g., Jean: +250...)" name="emergency_contact"/>
              </div>
            </div>
            <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="district">District</label>
                        <select id="primary_practice_district" name="district" class="form-control" required>
                            <option value="" disabled selected>Select district</option>
                            
                            <option value="Gasabo">Gasabo</option>
                            <option value="Kicukiro">Kicukiro</option>
                            <option value="Nyarugenge">Nyarugenge</option>

                            <option value="Bugesera">Bugesera</option>
                            <option value="Gatsibo">Gatsibo</option>
                            <option value="Kayonza">Kayonza</option>
                            <option value="Kirehe">Kirehe</option>
                            <option value="Ngoma">Ngoma</option>
                            <option value="Nyagatare">Nyagatare</option>
                            <option value="Rwamagana">Rwamagana</option>

                            <option value="Burera">Burera</option>
                            <option value="Gakenke">Gakenke</option>
                            <option value="Gicumbi">Gicumbi</option>
                            <option value="Musanze">Musanze</option>
                            <option value="Rulindo">Rulindo</option>

                            <option value="Gisagara">Gisagara</option>
                            <option value="Huye">Huye</option>
                            <option value="Kamonyi">Kamonyi</option>
                            <option value="Muhanga">Muhanga</option>
                            <option value="Nyamagabe">Nyamagabe</option>
                            <option value="Nyanza">Nyanza</option>
                            <option value="Nyaruguru">Nyaruguru</option>
                            <option value="Ruhango">Ruhango</option>

                            <option value="Karongi">Karongi</option>
                            <option value="Ngororero">Ngororero</option>
                            <option value="Nyabihu">Nyabihu</option>
                            <option value="Nyamasheke">Nyamasheke</option>
                            <option value="Rubavu">Rubavu</option>
                            <option value="Rusizi">Rusizi</option>
                            <option value="Rutsiro">Rutsiro</option>
                        </select>
                    </div>

                    <div class="col-md-6 mb-3">
                        <label for="sector">Sector</label>
                        <select id="primary_practice_sector" name="sector" class="form-control" disabled required>
                            <option value="" disabled selected>Select District First</option>
                        </select>
                    </div>
                </div>

            <div class="mb-3">
              <label>Email Address</label>
              <input type="email" class="form-control" placeholder="your.email@example.com" name="email" required/>
            </div>

            <div class="mb-3">
              <label>Password</label>
              <input type="password" class="form-control" placeholder="Create a password (min. 8 characters)" id="password" name="password" required/>
            </div>

            <div class="mb-3">
              <label>Confirm Password</label>
              <input type="password" class="form-control" placeholder="Re-enter your password" id="confirm_password" name="confirm_password" required/>
            </div>
            <div id="pw-message" style="color: #dc3545; font-size: 0.95em; margin-top: 3px;"></div>

            <div class="form-check mb-3">
              <input class="form-check-input" type="checkbox" required/>
              <label class="form-check-label">
                I agree to the <a href="#" class="text-success">Terms of Service</a> and
                <a href="#" class="text-success">Privacy Policy</a>
              </label>
            </div>

            <button type="submit" class="btn btn-success w-100 mb-3">Create Account</button>

            <p class="text-center">
              Already have an account?
              <a href="{% url 'patient_login' %}" class="text-success">Sign in</a>
            </p>
        </form>
      </div>

    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="{% static 'main.js' %}"></script>
  <script>
    const rwandaSectors = {
        // --- Kigali City ---
        "Gasabo": ["Bumbogo", "Gatsata", "Jali", "Gikomero", "Gisozi", "Jabana", "Kinyinya", "Ndera", "Nduba", "Rusororo", "Rutunga", "Kacyiru", "Kimihurura", "Kimironko", "Remera"],
        "Kicukiro": ["Gahanga", "Gatenga", "Gikondo", "Kagarama", "Kanombe", "Kicukiro", "Kigarama", "Masaka", "Niboye", "Nyarugunga"],
        "Nyarugenge": ["Gitega", "Kanyinya", "Kigali", "Kimisagara", "Mageragere", "Muhima", "Nyakabanda", "Nyamirambo", "Nyarugenge", "Rwezamenyo"],

        // --- Eastern Province ---
        "Bugesera": ["Gashora", "Juru", "Kamabuye", "Ntarama", "Mareba", "Mayange", "Musenyi", "Mwogo", "Ngeruka", "Nyamata", "Nyarugenge", "Rilima", "Ruhuha", "Rweru", "Shyara"],
        "Gatsibo": ["Gasange", "Gatsibo", "Gitoki", "Kabarore", "Kageyo", "Kiramuruzi", "Kiziguro", "Muhura", "Murambi", "Ngarama", "Nyagihanga", "Remera", "Rugarama", "Rwimbogo"],
        "Kayonza": ["Gahini", "Kabare", "Kabarondo", "Mukarange", "Murama", "Murundi", "Mwiri", "Ndego", "Nyamirama", "Rukara", "Ruramira", "Rwinkwavu"],
        "Kirehe": ["Gahara", "Gatore", "Kigina", "Kirehe", "Mahama", "Mpanga", "Musaza", "Mushikiri", "Nasho", "Nyamugari", "Nyarubuye", "Kigarama"],
        "Ngoma": ["Gashanda", "Jarama", "Karembo", "Kazo", "Kibungo", "Mugesera", "Murama", "Mutenderi", "Remera", "Rukira", "Rukumberi", "Rurenge", "Sake", "Zaza"],
        "Nyagatare": ["Gatunda", "Karama", "Karangazi", "Katabagemu", "Kiyombe", "Matimba", "Mimuri", "Mukama", "Musheri", "Nyagatare", "Rukomo", "Rwempasha", "Rwimiyaga", "Tabagwe"],
        "Rwamagana": ["Fumbwe", "Gahengeri", "Gishari", "Karenge", "Kigabiro", "Muhazi", "Munyaga", "Muyumbu", "Mwulire", "Nyakariro", "Nzige", "Rubona", "Rwamagana", "Sha"],

        // --- Northern Province ---
        "Burera": ["Bungwe", "Butaro", "Cyanika", "Cyeru", "Gahunga", "Gatebe", "Gitovu", "Kagogo", "Kinoni", "Kinyababa", "Kivuye", "Nemba", "Rugarama", "Rugendabari", "Ruhunde", "Rusarabuye", "Rwerere"],
        "Gakenke": ["Busengo", "Coko", "Cyabingo", "Gakenke", "Gashenyi", "Janja", "Kamubuga", "Karambo", "Kivuruga", "Mataba", "Minazi", "Mugunga", "Muhondo", "Muyongwe", "Muzo", "Nemba", "Ruli", "Rusasa", "Rushashi"],
        "Gicumbi": ["Bukure", "Bwisige", "Byumba", "Cyumba", "Giti", "Kaniga", "Manyagiro", "Miyove", "Kageyo", "Mukarange", "Muko", "Mutete", "Nyamiyaga", "NyankenkeII", "Rubaya", "Rukomo", "Rushaki", "Rutare", "Ruvune", "Rwamiko", "Shangasha"],
        "Musanze": ["Busogo", "Cyuve", "Gacaca", "Gashaki", "Gataraga", "Kimonyi", "Kinigi", "Muhoza", "Muko", "Musanze", "Nkotsi", "Nyange", "Remera", "Rwaza", "Shingiro"],
        "Rulindo": ["Base", "Burega", "Bushoki", "Buyoga", "Cyinzuzi", "Cyungo", "Kinihira", "Kisaro", "Masoro", "Mbogo", "Murambi", "Ngoma", "Ntarabana", "Rukozo", "Rusiga", "Shyorongi", "Tumba"],

        // --- Southern Province ---
        "Gisagara": ["Gikonko", "Gishubi", "Kansi", "Kibilizi", "Kigembe", "Mamba", "Muganza", "Mugombwa", "Mukindo", "Musha", "Ndora", "Nyanza", "Save"],
        "Huye": ["Gishamvu", "Karama", "Kigoma", "Kinazi", "Maraba", "Mbazi", "Mukura", "Ngoma", "Ruhashya", "Huye", "Rusatira", "Rwaniro", "Simbi", "Tumba"],
        "Kamonyi": ["Gacurabwenge", "Karama", "Kayenzi", "Kayumbu", "Mugina", "Musambira", "Ngamba", "Nyamiyaga", "Nyarubaka", "Rugarika", "Rukoma", "Runda"],
        "Muhanga": ["Cyeza", "Kabacuzi", "Kibangu", "Kiyumba", "Muhanga", "Mushishiro", "Nyabinoni", "Nyamabuye", "Nyarusange", "Rongi", "Rugendabari", "Shyogwe"],
        "Nyamagabe": ["Buruhukiro", "Cyanika", "Gatare", "Kaduha", "Kamegeri", "Kibirizi", "Kibumbwe", "Kitabi", "Mbazi", "Mugano", "Musange", "Musebeya", "Mushubi", "Nkomane", "Gasaka", "Tare", "Uwinkingi"],
        "Nyanza": ["Busasamana", "Busoro", "Cyabakamyi", "Kibirizi", "Kigoma", "Mukingo", "Muyira", "Ntyazo", "Nyagisozi", "Rwabicuma"],
        "Nyaruguru": ["Cyahinda", "Busanze", "Kibeho", "Mata", "Munini", "Kivu", "Ngera", "Ngoma", "Nyabimata", "Nyagisozi", "Muganza", "Ruheru", "Ruramba", "Rusenge"],
        "Ruhango": ["Bweramana", "Byimana", "Kabagari", "Kinazi", "Mbuye", "Mwendo", "Ntongwe", "Ruhango", "Shyogwe"],

        // --- Western Province ---
        "Karongi": ["Bwishyura", "Gishyita", "Gishari", "Gitesi", "Mubuga", "Murambi", "Murundi", "Mutuntu", "Rubengera", "Rugabano", "Ruganda", "Rwankuba", "Twumba"],
        "Ngororero": ["Bwira", "Gatumba", "Hindiro", "Kabaya", "Kageyo", "Kavumu", "Matyazo", "Muhanda", "Muhororo", "Ndaro", "Ngororero", "Nyange", "Sovu"],
        "Nyabihu": ["Bigogwe", "Jenda", "Jomba", "Kabatwa", "Karago", "Kintobo", "Mukamira", "Muringa", "Rambura", "Rugera", "Rurembo", "Shyira"],
        "Nyamasheke": ["Bushekeri", "Bushenge", "Cyato", "Gihombo", "Kagano", "Kanjongo", "Karambi", "Karengera", "Kirimbi", "Macuba", "Mahembe", "Nyabitekeri", "Rangiro", "Ruharambuga", "Shangi"],
        "Rubavu": ["Bugeshi", "Busasamana", "Cyanzarwe", "Gisenyi", "Kanama", "Kanzenze", "Mudende", "Nyakiriba", "Nyamyumba", "Nyundo", "Rubavu", "Rugerero"],
        "Rusizi": ["Bugarama", "Butare", "Bweyeye", "Gikundamvura", "Gashonga", "Giheke", "Gihundwe", "Gitambi", "Kamembe", "Muganza", "Mururu", "Nkanka", "Nkombo", "Nkungu", "Nyakabuye", "Nyakarenzo", "Nzahaha", "Rwimbogo"],
        "Rutsiro": ["Boneza", "Gihango", "Kigeyo", "Kivumu", "Manihira", "Mukura", "Murunda", "Musasa", "Mushonyi", "Mushubati", "Nyabirasi", "Ruhango", "Rusebeya"]
    };

    const districtSelect = document.getElementById('primary_practice_district');
    const sectorSelect = document.getElementById('primary_practice_sector');

    districtSelect.addEventListener('change', function() {
        const selectedDistrict = this.value; // Now returns just "Gasabo", etc.
        
        sectorSelect.innerHTML = '<option value="" disabled selected>Select Sector</option>';
        
        if (rwandaSectors[selectedDistrict]) {
            const sectors = rwandaSectors[selectedDistrict];
            
            sectors.forEach(function(sector) {
                const option = document.createElement('option');
                option.value = sector;
                option.textContent = sector;
                sectorSelect.appendChild(option);
            });
            
            sectorSelect.disabled = false;
        } else {
            sectorSelect.disabled = true;
        }
    });
</script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
{% if messages %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Define the Toast configuration
        const Toast = Swal.mixin({
            toast: true,
            position: 'top-end', // Top right corner
            showConfirmButton: false,
            timer: 3000, // Disappears after 3 seconds
            timerProgressBar: true,
            didOpen: (toast) => {
                toast.addEventListener('mouseenter', Swal.stopTimer)
                toast.addEventListener('mouseleave', Swal.resumeTimer)
            }
        });

        // Loop through Django messages
        {% for message in messages %}
            Toast.fire({
                icon: "{% if message.tags == 'error' %}error{% elif message.tags == 'success' %}success{% elif message.tags == 'warning' %}warning{% else %}info{% endif %}",
                title: "{{ message }}"
            });
        {% endfor %}
    });
</script>
</body>
</html>
